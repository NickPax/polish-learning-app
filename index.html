<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PolskiComprehend â€“ Real Polish Through Context</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* === EXACTLY THE SAME CSS AS GERMAN APP === */
* {
margin: 0;
padding: 0;
box-sizing: border-box;
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}
:root {
--primary: #7e22ce;
--secondary: #6b21a8;
--success: #4ade80;
--light-bg: #f8f9fa;
--dark-bg: #121826;
--card-light: #ffffff;
--card-dark: #1e293b;
--text-light: #212529;
--text-dark: #f1f5f9;
--shadow-light: rgba(0, 0, 0, 0.1);
--shadow-dark: rgba(0, 0, 0, 0.3);
--border-light: #dee2e6;
--border-dark: #334155;
--option-bg-light: white;
--option-bg-dark: #334155;
--correct: #4ade80;
--incorrect: #f87171;
--feedback-correct-light: #d1fae5;
--feedback-correct-dark: #064e3b;
--feedback-incorrect-light: #fee2e2;
--feedback-incorrect-dark: #7f1d1d;
--score-badge-bg: #fbbf24;
--score-badge-text: #1e293b;
}
body {
background: var(--bg);
color: var(--text);
min-height: 100vh;
padding: 20px;
transition: background-color 0.3s, color 0.3s;
}
.container {
max-width: 900px;
margin: 0 auto;
}
header {
text-align: center;
padding: 20px 0;
margin-bottom: 30px;
display: flex;
justify-content: space-between;
align-items: center;
}
.logo-container {
text-align: center;
flex: 1;
}
h1 {
font-size: 2.5rem;
color: var(--primary);
margin-bottom: 10px;
text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
}
.subtitle {
color: var(--secondary);
font-size: 1.1rem;
max-width: 600px;
margin: 0 auto;
}
.theme-toggle {
background: var(--card);
border: 1px solid var(--border);
width: 50px;
height: 50px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
box-shadow: 0 2px 6px var(--shadow);
transition: all 0.3s;
}
.theme-toggle:hover {
transform: rotate(20deg);
}
.progress-container {
background: var(--card);
border-radius: 12px;
padding: 20px;
box-shadow: 0 4px 12px var(--shadow);
margin-bottom: 30px;
border: 1px solid var(--border);
}
.progress-header {
display: flex;
justify-content: space-between;
margin-bottom: 10px;
font-weight: 600;
color: var(--secondary);
}
.progress-bar {
height: 12px;
background: var(--option-bg);
border-radius: 6px;
overflow: hidden;
border: 1px solid var(--border);
}
.progress-fill {
height: 100%;
background: linear-gradient(90deg, var(--primary), var(--success));
border-radius: 6px;
width: 0%;
transition: width 0.5s ease;
}
.points-display {
display: flex;
align-items: center;
justify-content: center;
gap: 10px;
margin-top: 15px;
font-size: 1.2rem;
font-weight: 700;
color: var(--warning);
}
.exercise-container {
background: var(--card);
border-radius: 12px;
padding: 30px;
box-shadow: 0 4px 12px var(--shadow);
margin-bottom: 30px;
min-height: 300px;
display: flex;
flex-direction: column;
border: 1px solid var(--border);
}
.exercise-title {
font-size: 1.5rem;
margin-bottom: 20px;
color: var(--secondary);
display: flex;
align-items: center;
gap: 10px;
justify-content: space-between;
}
.topic-name {
font-weight: 600;
color: var(--primary);
}
.back-btn {
background: none;
border: none;
color: var(--secondary);
font-weight: 600;
cursor: pointer;
display: flex;
align-items: center;
gap: 5px;
}
.back-btn:hover {
color: var(--primary);
}
.exercise-content {
flex: 1;
display: flex;
flex-direction: column;
justify-content: center;
}
.missing-word-exercise {
text-align: center;
}
.sentence {
font-size: 1.4rem;
line-height: 1.6;
margin-bottom: 25px;
padding: 15px;
background: var(--bg-sentence);
border-radius: 8px;
border-left: 4px solid var(--primary);
}
.options-container {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
gap: 12px;
margin-top: 20px;
}
.option-btn {
padding: 12px 15px;
border: 2px solid var(--border);
border-radius: 8px;
background: var(--option-bg);
font-size: 1.1rem;
cursor: pointer;
transition: all 0.2s;
font-weight: 600;
color: var(--text);
}
.option-btn:hover:not(:disabled) {
border-color: var(--primary);
transform: translateY(-2px);
box-shadow: 0 4px 8px var(--shadow);
}
.option-btn:disabled {
opacity: 0.8;
cursor: not-allowed;
}
.option-btn.selected {
background: var(--primary);
color: white;
border-color: var(--primary);
}
.option-btn.correct {
background: var(--correct);
border-color: var(--correct);
color: white;
}
.option-btn.incorrect {
background: var(--incorrect);
border-color: var(--incorrect);
color: white;
}
.tts-exercise {
text-align: center;
}
.audio-controls {
display: flex;
justify-content: center;
gap: 15px;
margin: 25px 0;
}
.play-btn {
width: 60px;
height: 60px;
border-radius: 50%;
background: var(--primary);
color: white;
border: none;
font-size: 1.5rem;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
box-shadow: 0 4px 12px var(--shadow);
transition: all 0.2s;
}
.play-btn:hover {
background: var(--secondary);
transform: scale(1.05);
}
.play-btn:disabled {
opacity: 0.6;
cursor: not-allowed;
transform: none;
}
.topics-container {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
gap: 15px;
margin-top: 20px;
}
.topic-card {
padding: 20px;
border: 2px solid var(--border);
border-radius: 10px;
background: var(--option-bg);
cursor: pointer;
transition: all 0.2s;
text-align: center;
font-weight: 600;
color: var(--text);
}
.topic-card:hover:not(.selected):not(.locked) {
border-color: var(--primary);
transform: translateY(-3px);
box-shadow: 0 4px 8px var(--shadow);
}
.topic-card.selected {
background: var(--primary);
color: white;
border-color: var(--primary);
}
.topic-card.locked {
opacity: 0.8;
cursor: not-allowed;
}
.feedback {
margin-top: 20px;
padding: 15px;
border-radius: 8px;
text-align: center;
font-weight: 600;
display: none;
}
.feedback.correct {
background: var(--feedback-correct);
color: var(--feedback-correct-text);
display: block;
}
.feedback.incorrect {
background: var(--feedback-incorrect);
color: var(--feedback-incorrect-text);
display: block;
}
.navigation {
display: flex;
justify-content: space-between;
margin-top: 20px;
}
.btn {
padding: 12px 25px;
border: none;
border-radius: 8px;
font-size: 1.1rem;
font-weight: 600;
cursor: pointer;
transition: all 0.2s;
}
.btn-prev {
background: var(--border);
color: var(--text);
}
.btn-prev:hover {
background: var(--primary);
color: white;
}
.btn-next {
background: var(--primary);
color: white;
}
.btn-next:hover {
background: var(--secondary);
}
.btn:disabled {
opacity: 0.6;
cursor: not-allowed;
}
.completion-screen, .topic-selection-screen {
text-align: center;
padding: 40px 20px;
}
.completion-screen h2, .topic-selection-screen h2 {
font-size: 2.2rem;
margin-bottom: 20px;
}
.final-score {
font-size: 1.8rem;
font-weight: 700;
color: var(--warning);
margin: 20px 0;
}
.action-buttons {
margin-top: 25px;
display: flex;
justify-content: center;
gap: 15px;
flex-wrap: wrap;
}
.restart-btn, .continue-btn, .new-topic-btn, .full-restart-btn {
background: var(--success);
color: white;
padding: 12px 25px;
border: none;
border-radius: 8px;
font-size: 1.1rem;
font-weight: 600;
cursor: pointer;
transition: all 0.2s;
}
.restart-btn:hover, .continue-btn:hover, .new-topic-btn:hover, .full-restart-btn:hover {
background: #3ab7e4;
transform: scale(1.03);
}
.topic-options {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
gap: 20px;
margin-top: 30px;
}
.topic-option {
padding: 25px 15px;
background: var(--card);
border: 2px solid var(--border);
border-radius: 12px;
cursor: pointer;
transition: all 0.3s;
font-weight: 600;
color: var(--text);
position: relative;
}
.topic-option:hover {
border-color: var(--primary);
transform: translateY(-5px);
box-shadow: 0 6px 12px var(--shadow);
}
.topic-option i {
display: block;
font-size: 2rem;
margin-bottom: 10px;
color: var(--primary);
}
.score-badge {
position: absolute;
top: 10px;
right: 10px;
background: var(--score-badge-bg);
color: var(--score-badge-text);
border-radius: 50%;
width: 28px;
height: 28px;
display: flex;
align-items: center;
justify-content: center;
font-size: 0.8rem;
font-weight: bold;
box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}
.hidden {
display: none;
}
@media (max-width: 600px) {
.exercise-container {
padding: 20px;
}
h1 {
font-size: 2rem;
}
.sentence {
font-size: 1.2rem;
}
.options-container, .topics-container, .topic-options {
grid-template-columns: 1fr;
}
header {
flex-direction: column;
gap: 15px;
}
.score-badge {
width: 24px;
height: 24px;
font-size: 0.7rem;
}
.action-buttons {
gap: 10px;
}
.restart-btn, .new-topic-btn {
padding: 10px 20px;
font-size: 1rem;
}
}
</style>
</head>
<body>
<div class="container">
<header>
<div class="logo-container">
<h1><i class="fas fa-language"></i> PolskiComprehend</h1>
<p class="subtitle">Master real Polish through interactive exercises. Perfect for beginners and intermediate learners!</p>
</div>
<div class="theme-toggle" id="theme-toggle">
<i class="fas fa-moon"></i>
</div>
</header>

<div class="progress-container hidden" id="progress-container">
<div class="progress-header">
<span>Progress</span>
<span id="progress-text">0/5</span>
</div>
<div class="progress-bar">
<div class="progress-fill" id="progress-fill"></div>
</div>
<div class="points-display">
<i class="fas fa-star"></i>
<span id="points">0</span> Points
</div>
</div>

<div class="exercise-container hidden" id="exercise-container">
<!-- Exercises will be loaded here -->
</div>

<div class="completion-screen hidden" id="completion-screen">
<h2 id="completion-message">Great Job! ðŸŒŸ</h2>
<p>You've completed the topic!</p>
<div class="final-score">Your Score: <span id="final-score">0</span>/50 points</div>
<div class="action-buttons">
<button class="new-topic-btn" id="new-topic-btn">Choose Another Topic</button>
<button class="restart-btn" id="restart-topic-btn">Retry This Topic</button>
</div>
</div>

<div class="topic-selection-screen" id="topic-selection-screen">
<h2>Choose a Topic to Learn</h2>
<p>Select any topic to start learning Polish!</p>
<div class="topic-options" id="topic-options-container">
<!-- Topics will be populated here -->
</div>
</div>

<script>
// === ALL 10 TOPICS WITH 3 SETS OF 5 EXERCISES EACH ===
const allTopics = {
food: {
name:"Food & Dining",
icon:"fa-utensils",
sets:[
[
{type:"missing-word",sentence:"PoproszÄ™ butelkÄ™ ___.",options:["wody","domu","samochodu","krzesÅ‚a"],correct:0,explanation:"'Wody' means water."},
{type:"tts",audioText:"Zupa jest wyÅ›mienita! PoproszÄ™ rachunek.",topics:["Complaining","Praising food","Asking for directions","Ordering clothes"],correct:1,explanation:"The speaker is praising the soup and asking for the bill."},
{type:"missing-word",sentence:"Ile kosztuje to ___?",options:["menu","ksiÄ™Å¼yc","mysz","kapelusz"],correct:0,explanation:"'Menu' is used in restaurants."},
{type:"tts",audioText:"Jestem wegetarianinem. Czy macie dania wegetariaÅ„skie?",topics:["Dietary needs","Allergies","Cooking at home","Fast food"],correct:0,explanation:"The speaker is asking about vegetarian options."},
{type:"missing-word",sentence:"ChciaÅ‚bym zamÃ³wiÄ‡ ___.",options:["piwo","ksiÄ…Å¼kÄ™","Å‚Ã³Å¼ko","Å‚Ã³dÅº"],correct:0,explanation:"'Piwo' means beer."}
],
[
{type:"missing-word",sentence:"Kan I see the ___ please?",options:["Speisekarte","Schere","Schlange","SchÃ¼ssel"],correct:0,explanation:"'Speisekarte' means menu."},
{type:"tts",audioText:"Ich hÃ¤tte gerne das Rindersteak medium gegart, bitte.",topics:["Ordering meat","Asking for drinks","Requesting dessert","Complaining about service"],correct:0,explanation:"The speaker is ordering a steak cooked medium."},
{type:"missing-word",sentence:"Das Essen war sehr ___.",options:["lecker","langsam","laut","leer"],correct:0,explanation:"'Lecker' means delicious."},
{type:"tts",audioText:"Haben Sie heute Mittag ein MittagsmenÃ¼?",topics:["Asking about lunch specials","Checking opening hours","Requesting takeout","Asking for reservations"],correct:0,explanation:"The speaker is asking about lunch specials."},
{type:"missing-word",sentence:"Ich bin ___ und esse kein Fleisch.",options:["vegetarisch","verrÃ¼ckt","verloren","verÃ¤rgert"],correct:0,explanation:"'Vegetarisch' means vegetarian."}
],
[
{type:"missing-word",sentence:"Noch ein ___ Kaffee, bitte.",options:["Tasse","Tisch","Tuch","Topf"],correct:0,explanation:"'Tasse' means cup."},
{type:"tts",audioText:"Die Vorspeise war fantastisch! Ich nehme das gleiche Hauptgericht wie gestern.",topics:["Praising food","Complaining","Asking for recommendations","Requesting the bill"],correct:0,explanation:"The speaker is praising the appetizer and ordering the same main course."},
{type:"missing-word",sentence:"Die Rechnung, ___!",options:["bitte","besser","billig","bunt"],correct:0,explanation:"'Bitte' means please."},
{type:"tts",audioText:"Entschuldigung, aber in meiner Suppe schwimmt eine Fliege!",topics:["Complaining about food","Ordering dessert","Asking for water","Requesting a table"],correct:0,explanation:"The speaker is complaining about finding a fly in their soup."},
{type:"missing-word",sentence:"Ich mÃ¶chte ein StÃ¼ck ___ bestellen.",options:["Torte","Tasche","TÃ¼r","Treppe"],correct:0,explanation:"'Torte' means cake."}
]
]
},
travel: {
name:"Travel & Directions",
icon:"fa-plane",
sets:[
[
{type:"missing-word",sentence:"Gdzie jest najbliÅ¼szy ___?",options:["dworzec","banan","niedÅºwiedÅº","ksiÄ…Å¼ka"],correct:0,explanation:"'Dworzec' means train station."},
{type:"tts",audioText:"Przepraszam, jak dojÅ›Ä‡ do muzeum? Czy to daleko stÄ…d?",topics:["Asking for directions","Buying tickets","Checking into a hotel","Renting a car"],correct:0,explanation:"The speaker is asking how to get to the museum."},
{type:"missing-word",sentence:"PotrzebujÄ™ ___ na trzy noce.",options:["pokÃ³j","cukier","gazeta","pociÄ…g"],correct:0,explanation:"'PokÃ³j' means room."},
{type:"tts",audioText:"PociÄ…g do Krakowa odjeÅ¼dÅ¼a z peronu 3. ProszÄ™ siÄ™ pospieszyÄ‡!",topics:["Train announcements","Flight information","Bus schedules","Taxi services"],correct:0,explanation:"This is a train announcement about departure from platform 3."},
{type:"missing-word",sentence:"Ile kosztuje bilet do ___?",options:["Warszawy","psa","domu","rÄ™ka"],correct:0,explanation:"'Warszawy' is Warsaw in genitive case."}
],
[
{type:"missing-word",sentence:"KÃ¶nnen Sie mir auf der Karte ___ zeigen?",options:["zeigen","ziehen","zÃ¤hlen","zahlen"],correct:0,explanation:"'Zeigen' means to show."},
{type:"tts",audioText:"Ich mÃ¶chte ein einfaches Zimmer mit Dusche und FrÃ¼hstÃ¼ck buchen.",topics:["Booking a hotel room","Renting a car","Buying souvenirs","Asking for tourist info"],correct:0,explanation:"The speaker is booking a simple room with shower and breakfast."},
{type:"missing-word",sentence:"Der Flug ___ pÃ¼nktlich.",options:["startet","steht","steigt","steuert"],correct:0,explanation:"'Startet' means departs (for flights)."},
{type:"tts",audioText:"Gibt es hier in der NÃ¤he eine Touristeninformation?",topics:["Asking for tourist info","Looking for restaurants","Finding public transport","Locating pharmacies"],correct:0,explanation:"The speaker is asking for a tourist information office."},
{type:"missing-word",sentence:"Ich habe meinen ___ verloren.",options:["Reisepass","Regenschirm","Rucksack","Ring"],correct:0,explanation:"'Reisepass' means passport."}
],
[
{type:"missing-word",sentence:"Fahren Sie geradeaus bis zur ___ Ampel.",options:["nÃ¤chsten","neuen","netten","nassen"],correct:0,explanation:"'NÃ¤chsten' means next."},
{type:"tts",audioText:"Entschuldigung, wo kann ich mein GepÃ¤ck aufbewahren?",topics:["Asking about luggage storage","Finding restrooms","Locating currency exchange","Requesting wheelchair assistance"],correct:0,explanation:"The speaker is asking where to store their luggage."},
{type:"missing-word",sentence:"Ich mÃ¶chte ein ___ zur Altstadt kaufen.",options:["Ticket","Tisch","Tuch","Topf"],correct:0,explanation:"'Ticket' is commonly used in German for public transport."},
{type:"tts",audioText:"Der Bus fÃ¤hrt alle 15 Minuten vom Hauptbahnhof ab.",topics:["Bus schedules","Train delays","Flight cancellations","Taxi availability"],correct:0,explanation:"The sentence describes bus frequency from the main station."},
{type:"missing-word",sentence:"Wie komme ich zum ___ Flughafen?",options:["nÃ¤chsten","neuen","netten","nassen"],correct:0,explanation:"'NÃ¤chsten' means nearest."}
]
]
},
family: {
name:"Family & Friends",
icon:"fa-users",
sets:[
[
{type:"missing-word",sentence:"To moja ___.",options:["siostra","szkoÅ‚a","but","wÄ…Å¼"],correct:0,explanation:"'Siostra' means sister."},
{type:"tts",audioText:"MÃ³j tata pracuje jako lekarz, a mama jest nauczycielkÄ….",topics:["Professions","Hobbies","Daily routine","Family members"],correct:3,explanation:"The speaker is talking about their parents (family members)."},
{type:"missing-word",sentence:"Masz ___?",options:["rodzeÅ„stwo","prezenty","gitara","ogrÃ³d"],correct:0,explanation:"'RodzeÅ„stwo' means siblings."},
{type:"tts",audioText:"Moje dziadkowie mieszkajÄ… w maÅ‚ej wsi na Mazurach.",topics:["Family members","Travel plans","Housing","Weather"],correct:0,explanation:"The speaker is talking about their grandparents (family members)."},
{type:"missing-word",sentence:"Jutro Å›wiÄ™tujemy urodziny ___ .",options:["babci","owoc","piec","ucho"],correct:0,explanation:"'Babci' means grandmother's."}
],
[
{type:"missing-word",sentence:"Mein ___ heiÃŸt Lukas.",options:["Bruder","Brief","Brot","Buch"],correct:0,explanation:"'Bruder' means brother."},
{type:"tts",audioText:"Meine Cousine kommt nÃ¤chsten Monat aus Ã–sterreich zu Besuch.",topics:["Family visits","Travel plans","Work meetings","School events"],correct:0,explanation:"The speaker is talking about their cousin visiting."},
{type:"missing-word",sentence:"Meine Eltern wohnen in ___ Haus.",options:["einem","einen","einer","eines"],correct:0,explanation:"'Einem' is the dative case for neuter nouns like 'Haus'."},
{type:"tts",audioText:"Ich habe zwei TÃ¶chter und einen Sohn.",topics:["Family composition","Work colleagues","Pet ownership","Friend groups"],correct:0,explanation:"The speaker is describing their children."},
{type:"missing-word",sentence:"Mein ___ ist verheiratet.",options:["Onkel","Ofen","Ohr","Ort"],correct:0,explanation:"'Onkel' means uncle."}
],
[
{type:"missing-word",sentence:"Meine ___ arbeitet in einer Bank.",options:["Tante","Tasche","TÃ¼r","Treppe"],correct:0,explanation:"'Tante' means aunt."},
{type:"tts",audioText:"Wir treffen uns jeden Sonntag mit der ganzen Familie zum Abendessen.",topics:["Family traditions","Work schedules","Hobby clubs","School activities"],correct:0,explanation:"The speaker describes a weekly family dinner tradition."},
{type:"missing-word",sentence:"Mein ___ ist fÃ¼nf Jahre alt.",options:["Neffe","Nacht","Name","Norden"],correct:0,explanation:"'Neffe' means nephew."},
{type:"tts",audioText:"Meine Schwiegereltern kommen morgen zu Besuch.",topics:["In-law visits","Friend gatherings","Business meetings","Doctor appointments"],correct:0,explanation:"The speaker mentions their in-laws visiting."},
{type:"missing-word",sentence:"Ich habe keine ___ mehr.",options:["GroÃŸeltern","Geschenke","Gitarre","Garten"],correct:0,explanation:"'GroÃŸeltern' means grandparents."}
]
]
},
shopping: {
name:"Shopping",
icon:"fa-shopping-bag",
sets:[
[
{type:"missing-word",sentence:"Ile kosztuje ta ___?",options:["kurtka","rok","chÅ‚opak","jogurt"],correct:0,explanation:"'Kurtka' means jacket."},
{type:"tts",audioText:"Czy macie te buty w rozmiarze 40?",topics:["Asking for size","Returning items","Asking for price","Opening hours"],correct:0,explanation:"The speaker is asking if shoes are available in size 40."},
{type:"missing-word",sentence:"ChciaÅ‚bym ___ tÄ™ spodnie.",options:["zamieniÄ‡","uczyÄ‡","rozwaÅ¼aÄ‡","Ä‡wiczyÄ‡"],correct:0,explanation:"'ZamieniÄ‡' means to exchange (return an item)."},
{type:"tts",audioText:"Kasa jest po lewej stronie sklepu.",topics:["Finding the cashier","Asking for discounts","Product availability","Store layout"],correct:0,explanation:"The speaker is being told where the cashier is located."},
{type:"missing-word",sentence:"Czy jest tu ___?",options:["zniÅ¼ka","deszcz","plecak","restauracja"],correct:0,explanation:"'ZniÅ¼ka' means discount."}
],
[
{type:"missing-word",sentence:"Kann ich mit ___ bezahlen?",options:["Karte","KÃ¤se","Kiste","Kugel"],correct:0,explanation:"'Karte' means card (credit/debit)."},
{type:"tts",audioText:"Entschuldigung, wo finde ich die Damenabteilung?",topics:["Finding departments","Asking for restrooms","Locating exits","Requesting assistance"],correct:0,explanation:"The speaker is asking for the women's department."},
{type:"missing-word",sentence:"Das ist zu ___.",options:["teuer","toll","traurig","treu"],correct:0,explanation:"'Teuer' means expensive."},
{type:"tts",audioText:"Haben Sie dieses Kleid auch in Blau?",topics:["Asking for colors","Checking sizes","Requesting discounts","Inquiring about materials"],correct:0,explanation:"The speaker is asking if the dress comes in blue."},
{type:"missing-word",sentence:"Ich suche ein Geschenk fÃ¼r meine ___.",options:["Mutter","Mond","Maus","MÃ¼tze"],correct:0,explanation:"'Mutter' means mother."}
],
[
{type:"missing-word",sentence:"Wo ist die ___?",options:["Umkleidekabine","UniversitÃ¤t","Uhr","Ãœbung"],correct:0,explanation:"'Umkleidekabine' means fitting room."},
{type:"tts",audioText:"KÃ¶nnen Sie mir helfen? Ich suche nach einem schwarzen Ledermantel.",topics:["Asking for assistance","Complaining about service","Returning items","Checking prices"],correct:0,explanation:"The speaker is asking for help finding a black leather coat."},
{type:"missing-word",sentence:"Ich nehme die ___ Farbe.",options:["andere","alte","arme","alle"],correct:0,explanation:"'Andere' means other."},
{type:"tts",audioText:"Die Ã–ffnungszeiten sind von 9 bis 20 Uhr.",topics:["Store hours","Sale periods","Delivery times","Return policies"],correct:0,explanation:"The sentence states store opening hours."},
{type:"missing-word",sentence:"Kann ich eine ___ bekommen?",options:["Quittung","Qualle","Quelle","Quark"],correct:0,explanation:"'Quittung' means receipt."}
]
]
},
hobbies: {
name:"Hobbies & Leisure",
icon:"fa-film",
sets:[
[
{type:"missing-word",sentence:"Gram chÄ™tnie na ___.",options:["fortepianie","ser","skrzynia","kulka"],correct:0,explanation:"'Fortepianie' means piano (locative)."},
{type:"tts",audioText:"W sobotÄ™ idÄ™ do kina, Å¼eby obejrzeÄ‡ nowy film Marvela.",topics:["Going to the movies","Reading books","Playing sports","Cooking"],correct:0,explanation:"The speaker is going to the cinema to watch a movie."},
{type:"missing-word",sentence:"Moim hobby jest ___.",options:["fotografia","okno","ryba","piÃ³ro"],correct:0,explanation:"'Fotografia' means photography."},
{type:"tts",audioText:"Codzien wieczorem czytam ksiÄ…Å¼kÄ™ przed snem.",topics:["Reading","Writing","Painting","Taniec"],correct:0,explanation:"The speaker reads a book every evening before bed."},
{type:"missing-word",sentence:"W weekend czÄ™sto chodzÄ™ ___.",options:["na wycieczki","czekaÄ‡","praÄ‡","Å¼yczyÄ‡"],correct:0,explanation:"'Na wycieczki' means hiking/trips."}
],
[
{type:"missing-word",sentence:"Ich spiele FuÃŸball im ___.",options:["Verein","Verkehr","Verstand","Vertrag"],correct:0,explanation:"'Verein' means club/team."},
{type:"tts",audioText:"Meine Lieblingsband spielt heute Abend im Park.",topics:["Attending concerts","Watching sports","Visiting museums","Going to restaurants"],correct:0,explanation:"The speaker mentions their favorite band playing in the park."},
{type:"missing-word",sentence:"Ich gehe gern ___.",options:["schwimmen","schreiben","schlieÃŸen","schneiden"],correct:0,explanation:"'Schwimmen' means swimming."},
{type:"tts",audioText:"Am Sonntag backe ich immer Kuchen fÃ¼r meine Familie.",topics:["Baking","Gardening","Painting","Playing video games"],correct:0,explanation:"The speaker bakes cake every Sunday for their family."},
{type:"missing-word",sentence:"Ich sammle alte ___.",options:["MÃ¼nzen","MÃ¼tzen","MÃ¤use","MÃ¶bel"],correct:0,explanation:"'MÃ¼nzen' means coins."}
],
[
{type:"missing-word",sentence:"Ich fotografiere gern ___.",options:["Landschaften","LÃ¶ffel","Lokale","Lieder"],correct:0,explanation:"'Landschaften' means landscapes."},
{type:"tts",audioText:"Jeden Donnerstag gehe ich zum Tanzen in die Stadthalle.",topics:["Dancing","Swimming","Reading","Cooking"],correct:0,explanation:"The speaker goes dancing every Thursday."},
{type:"missing-word",sentence:"Ich spiele ___ Gitarre.",options:["die","der","das","den"],correct:0,explanation:"'Die' is the correct article for 'Gitarre'."},
{type:"tts",audioText:"In meiner Freizeit male ich gerne Aquarellbilder.",topics:["Painting","Singing","Running","Shopping"],correct:0,explanation:"The speaker paints watercolors in their free time."},
{type:"missing-word",sentence:"Ich hÃ¶re gern ___ Musik.",options:["klassische","kalte","kaputte","kurze"],correct:0,explanation:"'Klassische' means classical."}
]
]
},
animals: {
name:"Animals & Nature",
icon:"fa-paw",
sets:[
[
{type:"missing-word",sentence:"Der ___ bellt laut.",options:["Hund","Hut","Haus","Hand"],correct:0,explanation:"'Hund' means dog."},
{type:"tts",audioText:"Im Wald gibt es viele Tiere wie Rehe, FÃ¼chse und EichhÃ¶rnchen.",topics:["City life","Forest animals","Ocean creatures","Farm animals"],correct:1,explanation:"The sentence describes forest animals."},
{type:"missing-word",sentence:"Die ___ fliegt hoch am Himmel.",options:["Vogel","Vase","Vogt","Voll"],correct:0,explanation:"'Vogel' means bird."},
{type:"tts",audioText:"Im FrÃ¼hling blÃ¼hen die Blumen und die BÃ¤ume bekommen neue BlÃ¤tter.",topics:["Seasons","Weather","Gardening","Nature cycles"],correct:3,explanation:"The sentence describes natural cycles in spring."},
{type:"missing-word",sentence:"Ich sehe einen ___ im Zoo.",options:["LÃ¶we","LÃ¶ffel","Lokal","Lied"],correct:0,explanation:"'LÃ¶we' means lion."}
],
[
{type:"missing-word",sentence:"Die ___ macht Muh.",options:["Kuh","Katze","Kiste","Kugel"],correct:0,explanation:"'Kuh' means cow."},
{type:"tts",audioText:"Am Strand kann man oft MÃ¶wen und Krabben sehen.",topics:["Beach wildlife","Forest animals","Mountain creatures","Desert species"],correct:0,explanation:"The sentence describes animals found at the beach."},
{type:"missing-word",sentence:"Der ___ klettert auf BÃ¤ume.",options:["Affe","Apfel","Arm","Auge"],correct:0,explanation:"'Affe' means monkey."},
{type:"tts",audioText:"Im Herbst fallen die BlÃ¤tter von den BÃ¤umen und die Tage werden kÃ¼rzer.",topics:["Autumn changes","Winter preparations","Spring renewal","Summer activities"],correct:0,explanation:"The sentence describes autumn changes."},
{type:"missing-word",sentence:"Die ___ summt um die Blumen.",options:["Biene","Banane","BÃ¤r","Buch"],correct:0,explanation:"'Biene' means bee."}
],
[
{type:"missing-word",sentence:"Der ___ brÃ¼llt laut.",options:["Tiger","Tisch","Tuch","Topf"],correct:0,explanation:"'Tiger' means tiger."},
{type:"tts",audioText:"Im Winter ziehen viele VÃ¶gel in wÃ¤rmere LÃ¤nder.",topics:["Bird migration","Hibernation","Plant growth","Ocean currents"],correct:0,explanation:"The sentence describes bird migration in winter."},
{type:"missing-word",sentence:"Die ___ hat lange Ohren.",options:["Hasen","Hose","Haus","Hand"],correct:0,explanation:"'Hasen' means rabbits."},
{type:"tts",audioText:"Im FrÃ¼hling schlÃ¼pfen die KÃ¼ken aus ihren Eiern.",topics:["Spring hatching","Summer breeding","Autumn harvesting","Winter sleeping"],correct:0,explanation:"The sentence describes chicks hatching in spring."},
{type:"missing-word",sentence:"Der ___ lebt im Dschungel.",options:["Papagei","Papier","Pferd","Pflanze"],correct:0,explanation:"'Papagei' means parrot."}
]
]
},
work: {
name:"Work & Office",
icon:"fa-briefcase",
sets:[
[
{type:"missing-word",sentence:"Mam waÅ¼ne ___ z szefem.",options:["spotkanie","sÅ‚oÅ„","stÃ³Å‚","sok"],correct:0,explanation:"'Spotkanie' means meeting."},
{type:"tts",audioText:"Czy mÃ³gÅ‚byÅ› przesÅ‚aÄ‡ mi tÄ™ prezentacjÄ™ mailem?",topics:["ProÅ›by","Skargi","Plotki","Rozkazy"],correct:0,explanation:"Polite request for presentation via email."},
{type:"missing-word",sentence:"MÃ³j ___ jest dziÅ› bardzo zajÄ™ty.",options:["kolega","kot","kubek","klucz"],correct:0,explanation:"'Kolega' means colleague."},
{type:"tts",audioText:"Firma rekrutuje nowych pracownikÃ³w do dziaÅ‚u marketingu.",topics:["Praca","WiadomoÅ›ci firmowe","Plotki","Skargi"],correct:0,explanation:"Job opening in marketing."},
{type:"missing-word",sentence:"MuszÄ™ napisaÄ‡ ___.",options:["raport","rower","rÄ™kawiczki","rakietÄ™"],correct:0,explanation:"'Raport' means report."}
],
[
{type:"missing-word",sentence:"Ich arbeite als ___.",options:["Ingenieur","Igel","Insel","Idee"],correct:0,explanation:"'Ingenieur' means engineer."},
{type:"tts",audioText:"KÃ¶nnten Sie das bitte wiederholen? Ich habe Sie nicht verstanden.",topics:["Asking for clarification","Making complaints","Giving instructions","Sharing personal news"],correct:0,explanation:"The speaker is asking for repetition due to misunderstanding."},
{type:"missing-word",sentence:"Die ___ beginnt um 9 Uhr.",options:["Arbeit","Arzt","Arm","Auge"],correct:0,explanation:"'Arbeit' means work."},
{type:"tts",audioText:"Ich muss Ãœberstunden machen, weil das Projekt morgen fertig sein muss.",topics:["Working overtime","Taking vacation","Quitting job","Asking for raise"],correct:0,explanation:"The speaker mentions working overtime to meet a deadline."},
{type:"missing-word",sentence:"Ich brauche einen neuen ___.",options:["Computer","Cousin","Creme","Cello"],correct:0,explanation:"'Computer' is the same in German."}
],
[
{type:"missing-word",sentence:"Mein ___ ist krank.",options:["Chef","Chor","Chips","Chemie"],correct:0,explanation:"'Chef' means boss."},
{type:"tts",audioText:"KÃ¶nnten Sie mir bitte helfen? Ich verstehe diese Excel-Tabelle nicht.",topics:["Asking for help","Complaining about software","Requesting training","Reporting bugs"],correct:0,explanation:"The speaker is asking for help with an Excel spreadsheet."},
{type:"missing-word",sentence:"Ich habe heute ___ frei.",options:["Urlaub","Uhr","UniversitÃ¤t","Ãœbung"],correct:0,explanation:"'Urlaub' means vacation."},
{type:"tts",audioText:"Die Konferenz findet nÃ¤chste Woche im Hauptquartier statt.",topics:["Conference announcements","Team meetings","Client visits","Training sessions"],correct:0,explanation:"The sentence announces a conference at headquarters."},
{type:"missing-word",sentence:"Ich muss eine ___ senden.",options:["E-Mail","Esel","Erdbeere","Ecke"],correct:0,explanation:"'E-Mail' is commonly used in German."}
]
]
},
health: {
name:"Health & Body",
icon:"fa-heartbeat",
sets:[
[
{type:"missing-word",sentence:"MÃ³j ___ boli.",options:["gÅ‚owa","gruszka","grzebieÅ„","grill"],correct:0,explanation:"'GÅ‚owa' means head."},
{type:"tts",audioText:"Mam silny bÃ³l brzucha i mdÅ‚oÅ›ci.",topics:["Objawy","Plany","Jedzenie","Pogoda"],correct:0,explanation:"Describing stomach pain."},
{type:"missing-word",sentence:"WeÅº ___ tabletki trzy razy dziennie.",options:["te","ten","to","ta"],correct:0,explanation:"'Te' is plural demonstrative for 'tabletki'."},
{type:"tts",audioText:"PowinieneÅ› piÄ‡ wiÄ™cej wody i mniej kawy.",topics:["WskazÃ³wki","Sen","Ä†wiczenia","Leki"],correct:0,explanation:"Hydration advice."},
{type:"missing-word",sentence:"IdÄ™ na ___ do dentysty.",options:["wizytÄ™","wÃ³zek","wÄ™dkÄ™","wiatr"],correct:0,explanation:"'WizytÄ™' means appointment."}
],
[
{type:"missing-word",sentence:"Mam starÄ… ___ Schmerzen.",options:["Bauch","Buch","Bett","Boot"],correct:0,explanation:"'Bauch' means stomach."},
{type:"tts",audioText:"Ich brauche ein Rezept fÃ¼r Antibiotika.",topics:["Requesting medication","Asking for test results","Scheduling appointments","Discussing diet"],correct:0,explanation:"The speaker needs a prescription for antibiotics."},
{type:"missing-word",sentence:"Mein ___ pocht.",options:["Herz","Hemd","Hund","Haus"],correct:0,explanation:"'Herz' means heart."},
{type:"tts",audioText:"Ich sollte mehr Wasser trinken und weniger Kaffee.",topics:["Hydration advice","Sleep recommendations","Exercise routines","Medication schedules"],correct:0,explanation:"The speaker discusses drinking more water and less coffee."},
{type:"missing-word",sentence:"Ich habe einen ___ Termin.",options:["Arzt","Auto","Apfel","Auge"],correct:0,explanation:"'Arzttermin' means doctor's appointment."}
],
[
{type:"missing-word",sentence:"Mein ___ juckt.",options:["Arm","Apfel","Auto","Auge"],correct:0,explanation:"'Arm' means arm."},
{type:"tts",audioText:"Ich muss meine Medikamente um 8 Uhr morgens nehmen.",topics:["Medication schedule","Diet plan","Exercise routine","Sleep schedule"],correct:0,explanation:"The speaker mentions taking medication at 8 AM."},
{type:"missing-word",sentence:"Ich fÃ¼hle mich ___.",options:["mÃ¼de","mild","mager","munter"],correct:0,explanation:"'MÃ¼de' means tired."},
{type:"tts",audioText:"Ich habe seit zwei Tagen Durchfall und Erbrechen.",topics:["Describing severe symptoms","Reporting minor aches","Discussing allergies","Talking about sleep"],correct:0,explanation:"The speaker describes severe gastrointestinal symptoms."},
{type:"missing-word",sentence:"Ich brauche ___ Ruhe.",options:["mehr","mein","meist","mitten"],correct:0,explanation:"'Mehr' means more."}
]
]
},
school: {
name:"School & Education",
icon:"fa-graduation-cap",
sets:[
[
{type:"missing-word",sentence:"Die ___ beginnt um 8 Uhr.",options:["Schule","Schuh","Schlange","SchÃ¼ssel"],correct:0,explanation:"'Schule' means school."},
{type:"tts",audioText:"FÃ¼r die PrÃ¼fung mÃ¼ssen wir Kapitel 1 bis 5 lernen.",topics:["Exam preparation","Homework complaints","Teacher praise","Classroom rules"],correct:0,explanation:"The speaker is talking about exam preparation."},
{type:"missing-word",sentence:"Ich habe eine gute ___ in Mathe bekommen.",options:["Note","Nase","Nacht","Nummer"],correct:0,explanation:"'Note' means grade/mark."},
{type:"tts",audioText:"In der Pause spielen wir FuÃŸball auf dem Schulhof.",topics:["Recess activities","Classroom lessons","Homework","After-school clubs"],correct:0,explanation:"The sentence describes recess activities."},
{type:"missing-word",sentence:"Mein ___ hilft mir bei den Hausaufgaben.",options:["Lehrer","LÃ¶ffel","Lokal","Lied"],correct:0,explanation:"'Lehrer' means teacher."}
],
[
{type:"missing-word",sentence:"Ich gehe in die ___ Klasse.",options:["achte","alte","arme","alle"],correct:0,explanation:"'Achte' means eighth (as in 8th grade)."},
{type:"tts",audioText:"Die Hausaufgaben fÃ¼r morgen sind auf Seite 45, Aufgabe 3.",topics:["Homework assignments","Test announcements","Field trip details","Club meeting times"],correct:0,explanation:"The speaker gives homework instructions."},
{type:"missing-word",sentence:"Wir haben heute ___ Unterricht.",options:["Musik","Mutter","Mund","Maus"],correct:0,explanation:"'Musik' means music."},
{type:"tts",audioText:"Die Klassenarbeit in Geschichte war sehr schwer.",topics:["Test difficulty","Homework load","Teacher behavior","Classroom environment"],correct:0,explanation:"The speaker comments on a difficult history test."},
{type:"missing-word",sentence:"Ich brauche ein neues ___ Heft.",options:["Mathe","Mutter","Mund","Maus"],correct:0,explanation:"'Mathe' means math."}
],
[
{type:"missing-word",sentence:"Die ___ klingelt um 12 Uhr.",options:["Pause","Puppe","Pfanne","Pflanze"],correct:0,explanation:"'Pause' means break/recess."},
{type:"tts",audioText:"Unser Physiklehrer erklÃ¤rt die Versuche immer sehr anschaulich.",topics:["Teacher praise","Subject complaints","Homework issues","Classroom rules"],correct:0,explanation:"The speaker praises their physics teacher's explanations."},
{type:"missing-word",sentence:"Ich lerne fÃ¼r die ___ PrÃ¼fung.",options:["Abschluss","Apfel","Auto","Auge"],correct:0,explanation:"'AbschlussprÃ¼fung' means final exam."},
{type:"tts",audioText:"In der Bibliothek muss man leise sein.",topics:["Library rules","Classroom behavior","Cafeteria etiquette","Playground safety"],correct:0,explanation:"The sentence states a library rule about being quiet."},
{type:"missing-word",sentence:"Mein ___ Fach ist Biologie.",options:["Lieblings","Langes","Lautes","Leeres"],correct:0,explanation:"'Lieblingsfach' means favorite subject."}
]
]
},
cities: {
name:"Cities & Places",
icon:"fa-city",
sets:[
[
{type:"missing-word",sentence:"Berlin jest ___ Niemiec.",options:["stolicÄ…","stacjÄ…","stadionem","sklepem"],correct:0,explanation:"'StolicÄ…' means capital city."},
{type:"tts",audioText:"In MÃ¼nchen gibt es das berÃ¼hmte Oktoberfest und viele schÃ¶ne Parks.",topics:["City attractions","Country comparisons","Rural life","Transport systems"],correct:0,explanation:"The sentence describes attractions in Munich."},
{type:"missing-word",sentence:"Das ___ ist sehr alt und historisch.",options:["Schloss","Schuh","Schlange","SchÃ¼ssel"],correct:0,explanation:"'Schloss' means castle."},
{type:"tts",audioText:"Die Altstadt von Heidelberg ist bekannt fÃ¼r ihre romantische AtmosphÃ¤re.",topics:["Historic districts","Modern architecture","Industrial areas","Suburban life"],correct:0,explanation:"The sentence describes Heidelberg's historic old town."},
{type:"missing-word",sentence:"Ich besuche das ___ am Wochenende.",options:["Museum","Mond","Maus","MÃ¼tze"],correct:0,explanation:"'Museum' is the same in German."}
],
[
{type:"missing-word",sentence:"Hamburg hat einen groÃŸen ___ Hafen.",options:["Seehafen","Schuh","Schlange","SchÃ¼ssel"],correct:0,explanation:"'Seehafen' means seaport."},
{type:"tts",audioText:"In Frankfurt gibt es viele Wolkenkratzer und die berÃ¼hmte Skyline.",topics:["City skylines","Historical sites","Natural landscapes","Rural villages"],correct:0,explanation:"The sentence describes Frankfurt's modern skyline."},
{type:"missing-word",sentence:"KÃ¶ln ist berÃ¼hmt fÃ¼r seinen ___ Dom.",options:["KÃ¶lner","Kalter","Kleiner","Krummer"],correct:0,explanation:"'KÃ¶lner Dom' is the famous Cologne Cathedral."},
{type:"tts",audioText:"Dresden wird oft als 'Elbflorenz' bezeichnet wegen ihrer schÃ¶nen Architektur.",topics:["Architectural nicknames","Industrial cities","Mountain towns","Coastal resorts"],correct:0,explanation:"The sentence explains Dresden's nickname 'Elbflorenz'."},
{type:"missing-word",sentence:"In ___ gibt es die berÃ¼hmte Frauenkirche.",options:["Dresden","Dorf","Dach","Decke"],correct:0,explanation:"The Frauenkirche is a famous church in Dresden."}
],
[
{type:"missing-word",sentence:"Die ___ ist die lÃ¤ngste StraÃŸe in Berlin.",options:["Unter den Linden","Unterhemd","Unterlage","Unterkunft"],correct:0,explanation:"'Unter den Linden' is a famous boulevard in Berlin."},
{type:"tts",audioText:"Der Schwarzwald ist eine beliebte Urlaubsregion im SÃ¼dwesten Deutschlands.",topics:["Tourist regions","Urban centers","Industrial zones","Coastal areas"],correct:0,explanation:"The sentence describes the Black Forest as a tourist region."},
{type:"missing-word",sentence:"Der ___ See ist der grÃ¶ÃŸte See in Deutschland.",options:["Bodensee","Boden","Boot","Buch"],correct:0,explanation:"'Bodensee' is Lake Constance, the largest lake in Germany."},
{type:"tts",audioText:"Die Zugspitze ist der hÃ¶chste Berg Deutschlands und liegt in den Alpen.",topics:["Mountains","Rivers","Forests","Deserts"],correct:0,explanation:"The sentence identifies Germany's highest mountain."},
{type:"missing-word",sentence:"Der Rhein ist ein wichtiger ___ in Europa.",options:["Fluss","Fisch","Felsen","Feld"],correct:0,explanation:"'Fluss' means river."}
]
]
}
};

// Track last used sets per topic to ensure variety
let topicSetHistory = JSON.parse(localStorage.getItem('polskiLernenSetHistory')) || {};

// Shuffle array helper function
function shuffleArray(array) {
const newArray = [...array];
for (let i = newArray.length - 1; i > 0; i--) {
const j = Math.floor(Math.random() * (i + 1));
[newArray[i], newArray[j]] = [newArray[j], newArray[i]];
}
return newArray;
}

// Randomize correct answer position
function randomizeOptions(options, correctIndex) {
const correctAnswer = options[correctIndex];
const incorrectAnswers = options.filter((_, i) => i !== correctIndex);
const shuffledIncorrect = shuffleArray(incorrectAnswers);
const correctPos = Math.floor(Math.random() * options.length);
const newOptions = [];
let incorrectIndex = 0;
for (let i = 0; i < options.length; i++) {
if (i === correctPos) {
newOptions.push(correctAnswer);
} else {
newOptions.push(shuffledIncorrect[incorrectIndex++]);
}
}
return {
options: newOptions,
correctIndex: newOptions.indexOf(correctAnswer)
};
}

// Select a random set that hasn't been used recently
function selectRandomSet(topicKey) {
const sets = allTopics[topicKey].sets;
const numSets = sets.length;
// Initialize history if needed
if (!topicSetHistory[topicKey]) {
topicSetHistory[topicKey] = [];
}
// Get available sets (not in last 2 used)
const availableSets = [];
for (let i = 0; i < numSets; i++) {
if (!topicSetHistory[topicKey].slice(-2).includes(i)) {
availableSets.push(i);
}
}
// If all sets were recently used, reset history
if (availableSets.length === 0) {
topicSetHistory[topicKey] = [];
for (let i = 0; i < numSets; i++) {
availableSets.push(i);
}
}
// Select random from available
const randomIndex = availableSets[Math.floor(Math.random() * availableSets.length)];
// Update history
topicSetHistory[topicKey].push(randomIndex);
localStorage.setItem('polskiLernenSetHistory', JSON.stringify(topicSetHistory));
return randomIndex;
}

// Scroll to next button smoothly
function scrollToNextButton() {
setTimeout(() => {
const nextBtn = document.querySelector('.btn-next');
if (nextBtn) {
nextBtn.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}
}, 100);
}

// App state
let currentTopic = null;
let currentExercise = 0;
let points = 0;
let userAnswers = [];
let speechSynthesis = window.speechSynthesis;
let isDarkMode = localStorage.getItem('darkMode') === 'true';
let topicBestScores = JSON.parse(localStorage.getItem('polskiLernenBestScores')) || {};
let currentSetIndex = null;

// DOM elements
const exerciseContainer = document.getElementById('exercise-container');
const progressContainer = document.getElementById('progress-container');
const progressFill = document.getElementById('progress-fill');
const progressText = document.getElementById('progress-text');
const pointsDisplay = document.getElementById('points');
const completionScreen = document.getElementById('completion-screen');
const finalScore = document.getElementById('final-score');
const completionMessage = document.getElementById('completion-message');
const topicSelectionScreen = document.getElementById('topic-selection-screen');
const topicOptionsContainer = document.getElementById('topic-options-container');
const themeToggle = document.getElementById('theme-toggle');
const newTopicBtn = document.getElementById('new-topic-btn');
const restartTopicBtn = document.getElementById('restart-topic-btn');

// Set initial theme
applyTheme();

// Toggle dark mode
themeToggle.addEventListener('click', () => {
isDarkMode = !isDarkMode;
localStorage.setItem('darkMode', isDarkMode);
applyTheme();
const icon = themeToggle.querySelector('i');
icon.className = isDarkMode ? 'fas fa-sun' : 'fas fa-moon';
});

function applyTheme() {
const root = document.documentElement;
if (isDarkMode) {
root.style.setProperty('--bg', 'var(--dark-bg)');
root.style.setProperty('--text', 'var(--text-dark)');
root.style.setProperty('--card', 'var(--card-dark)');
root.style.setProperty('--border', 'var(--border-dark)');
root.style.setProperty('--option-bg', 'var(--option-bg-dark)');
root.style.setProperty('--bg-sentence', 'rgba(30, 41, 59, 0.7)');
root.style.setProperty('--shadow', 'var(--shadow-dark)');
root.style.setProperty('--feedback-correct', 'var(--feedback-correct-dark)');
root.style.setProperty('--feedback-correct-text', 'white');
root.style.setProperty('--feedback-incorrect', 'var(--feedback-incorrect-dark)');
root.style.setProperty('--feedback-incorrect-text', 'white');
root.style.setProperty('--warning', '#fbbf24');
} else {
root.style.setProperty('--bg', 'var(--light-bg)');
root.style.setProperty('--text', 'var(--text-light)');
root.style.setProperty('--card', 'var(--card-light)');
root.style.setProperty('--border', 'var(--border-light)');
root.style.setProperty('--option-bg', 'var(--option-bg-light)');
root.style.setProperty('--bg-sentence', '#f1f5ff');
root.style.setProperty('--shadow', 'var(--shadow-light)');
root.style.setProperty('--feedback-correct', 'var(--feedback-correct-light)');
root.style.setProperty('--feedback-correct-text', 'var(--text-light)');
root.style.setProperty('--feedback-incorrect', 'var(--feedback-incorrect-light)');
root.style.setProperty('--feedback-incorrect-text', 'var(--text-light)');
root.style.setProperty('--warning', '#f8961e');
}
}

// Initialize the app
function initApp() {
renderTopicSelection();
newTopicBtn.addEventListener('click', showTopicSelection);
restartTopicBtn.addEventListener('click', () => startTopicExercises(currentTopic));
}

// Render topic selection screen
function renderTopicSelection() {
topicOptionsContainer.innerHTML = '';
Object.keys(allTopics).forEach(topicKey => {
const topic = allTopics[topicKey];
const bestScore = topicBestScores[topicKey] || 0;
const topicOption = document.createElement('div');
topicOption.className = 'topic-option';
topicOption.dataset.topic = topicKey;
topicOption.innerHTML = `
<i class="fas ${topic.icon}"></i>
${topic.name}
${bestScore > 0 ? `<div class="score-badge">${Math.round(bestScore)}</div>` : ''}
`;
topicOption.addEventListener('click', () => startTopicExercises(topicKey));
topicOptionsContainer.appendChild(topicOption);
});
}

// Start topic exercises
function startTopicExercises(topicKey) {
topicSelectionScreen.classList.add('hidden');
progressContainer.classList.remove('hidden');
exerciseContainer.classList.remove('hidden');
completionScreen.classList.add('hidden');
currentTopic = topicKey;
currentExercise = 0;
points = 0;
currentSetIndex = selectRandomSet(topicKey);
const exercises = allTopics[topicKey].sets[currentSetIndex];
userAnswers = new Array(exercises.length).fill(null);
pointsDisplay.textContent = points;
updateProgress();
loadExercise(currentExercise);
}

// Load and display current exercise
function loadExercise(index) {
const topicData = allTopics[currentTopic];
const exercises = topicData.sets[currentSetIndex];
const exercise = exercises[index];
exerciseContainer.innerHTML = '';
const titleContainer = document.createElement('div');
titleContainer.className = 'exercise-title';
titleContainer.innerHTML = `
<span><i class="fas fa-${exercise.type === 'missing-word' ? 'puzzle-piece' : 'headphones'}"></i> ${exercise.type === 'missing-word' ? 'Fill in the Blank' : 'Listen & Identify Topic'}</span>
<div>
<span class="topic-name">${topicData.name}</span>
<button class="back-btn" id="back-to-topics-btn">
<i class="fas fa-arrow-left"></i> Topics
</button>
</div>
`;
exerciseContainer.appendChild(titleContainer);
setTimeout(() => {
const backBtn = document.getElementById('back-to-topics-btn');
if (backBtn) {
backBtn.addEventListener('click', showTopicSelection);
}
}, 0);

if (exercise.type === 'missing-word') {
const randomized = randomizeOptions(exercise.options, exercise.correct);
exercise.currentOptions = randomized.options;
exercise.currentCorrect = randomized.correctIndex;
}
if (exercise.type === 'tts') {
const topics = [...exercise.topics];
const correctTopic = topics[exercise.correct];
const shuffledTopics = shuffleArray(topics);
const newCorrectIndex = shuffledTopics.indexOf(correctTopic);
exercise.currentTopics = shuffledTopics;
exercise.currentCorrect = newCorrectIndex;
}

if (exercise.type === 'missing-word') {
renderMissingWordExercise(exercise, exercises);
} else if (exercise.type === 'tts') {
renderTTsExercise(exercise);
}
}

// Render missing word exercise
function renderMissingWordExercise(exercise, exercises) {
const content = document.createElement('div');
content.className = 'exercise-content missing-word-exercise';
const sentence = document.createElement('div');
sentence.className = 'sentence';
sentence.textContent = exercise.sentence;
content.appendChild(sentence);
const optionsContainer = document.createElement('div');
optionsContainer.className = 'options-container';
const options = exercise.currentOptions;
const correctIndex = exercise.currentCorrect;
options.forEach((option, index) => {
const optionBtn = document.createElement('button');
optionBtn.className = 'option-btn';
optionBtn.textContent = option;
optionBtn.dataset.index = index;
if (userAnswers[currentExercise] !== undefined && userAnswers[currentExercise] !== null) {
optionBtn.disabled = true;
if (index === userAnswers[currentExercise]) {
optionBtn.classList.add('selected');
if (index === correctIndex) {
optionBtn.classList.add('correct');
} else {
optionBtn.classList.add('incorrect');
}
} else if (index === correctIndex) {
optionBtn.classList.add('correct');
}
}
optionBtn.addEventListener('click', () => handleMissingWordAnswer(index, correctIndex, exercise, exercises));
optionsContainer.appendChild(optionBtn);
});
content.appendChild(optionsContainer);
const feedback = document.createElement('div');
feedback.className = 'feedback';
feedback.id = 'feedback';
content.appendChild(feedback);
exerciseContainer.appendChild(content);
addNavigation();
}

// Handle missing word answer
function handleMissingWordAnswer(selectedIndex, correctIndex, exercise, exercises) {
userAnswers[currentExercise] = selectedIndex;
if (selectedIndex === correctIndex) {
points += 10;
pointsDisplay.textContent = points;
}
const buttons = document.querySelectorAll('.option-btn');
buttons.forEach((btn, index) => {
btn.disabled = true;
if (index === selectedIndex) {
btn.classList.add('selected');
if (index === correctIndex) {
btn.classList.add('correct');
} else {
btn.classList.add('incorrect');
}
} else if (index === correctIndex) {
btn.classList.add('correct');
}
});
const feedback = document.getElementById('feedback');
if (selectedIndex === correctIndex) {
feedback.textContent = `Correct! ${exercise.explanation}`;
feedback.className = 'feedback correct';
const fullCorrectSentence = exercise.sentence.replace("___", exercise.options[exercise.correct]);
setTimeout(() => speakText(fullCorrectSentence), 500);
} else {
feedback.textContent = `Incorrect. ${exercise.explanation}`;
feedback.className = 'feedback incorrect';
const fullCorrectSentence = exercise.sentence.replace("___", exercise.options[exercise.correct]);
setTimeout(() => speakText(fullCorrectSentence), 1000);
}
document.querySelector('.btn-next').disabled = false;
scrollToNextButton();
}

// Render TTS exercise
function renderTTsExercise(exercise) {
const content = document.createElement('div');
content.className = 'exercise-content tts-exercise';
const instruction = document.createElement('p');
instruction.textContent = 'Listen to the Polish sentence and select the correct topic:';
instruction.style.marginBottom = '20px';
instruction.style.fontSize = '1.1rem';
content.appendChild(instruction);
const audioControls = document.createElement('div');
audioControls.className = 'audio-controls';
const playBtn = document.createElement('button');
playBtn.className = 'play-btn';
playBtn.innerHTML = '<i class="fas fa-play"></i>';
playBtn.title = 'Play audio';
playBtn.addEventListener('click', () => {
speakText(exercise.audioText);
playBtn.disabled = true;
setTimeout(() => {
playBtn.disabled = false;
}, 5000);
});
audioControls.appendChild(playBtn);
content.appendChild(audioControls);
const topicsContainer = document.createElement('div');
topicsContainer.className = 'topics-container';
const topics = exercise.currentTopics;
const correctIndex = exercise.currentCorrect;
topics.forEach((topic, index) => {
const topicCard = document.createElement('div');
topicCard.className = 'topic-card';
topicCard.textContent = topic;
topicCard.dataset.index = index;
if (userAnswers[currentExercise] !== undefined && userAnswers[currentExercise] !== null) {
topicCard.classList.add('locked');
if (index === userAnswers[currentExercise]) {
topicCard.classList.add('selected');
}
if (userAnswers[currentExercise] !== correctIndex && index === correctIndex) {
topicCard.classList.add('correct');
}
}
topicCard.addEventListener('click', () => handleTTSAnswer(index, correctIndex, exercise));
topicsContainer.appendChild(topicCard);
});
content.appendChild(topicsContainer);
const feedback = document.createElement('div');
feedback.className = 'feedback';
feedback.id = 'feedback';
content.appendChild(feedback);
exerciseContainer.appendChild(content);
addNavigation();
}

// Handle TTS answer
function handleTTSAnswer(selectedIndex, correctIndex, exercise) {
userAnswers[currentExercise] = selectedIndex;
if (selectedIndex === correctIndex) {
points += 10;
pointsDisplay.textContent = points;
}
const cards = document.querySelectorAll('.topic-card');
cards.forEach((card, index) => {
card.classList.add('locked');
if (index === selectedIndex) {
card.classList.add('selected');
}
if (index === correctIndex) {
card.classList.add('correct');
}
});
const feedback = document.getElementById('feedback');
if (selectedIndex === correctIndex) {
feedback.textContent = `Correct! ${exercise.explanation}`;
feedback.className = 'feedback correct';
} else {
feedback.textContent = `Incorrect. ${exercise.explanation}`;
feedback.className = 'feedback incorrect';
}
document.querySelector('.btn-next').disabled = false;
scrollToNextButton();
}

// Text-to-speech function
function speakText(text) {
speechSynthesis.cancel();
const utterance = new SpeechSynthesisUtterance(text);
utterance.lang = 'pl-PL';
utterance.rate = 0.9;
utterance.pitch = 1;
speechSynthesis.speak(utterance);
}

// Add navigation buttons
function addNavigation() {
const nav = document.createElement('div');
nav.className = 'navigation';
const prevBtn = document.createElement('button');
prevBtn.className = 'btn btn-prev';
prevBtn.textContent = 'Previous';
prevBtn.disabled = currentExercise === 0;
prevBtn.addEventListener('click', () => {
if (currentExercise > 0) {
currentExercise--;
loadExercise(currentExercise);
updateProgress();
}
});
const nextBtn = document.createElement('button');
nextBtn.className = 'btn btn-next';
nextBtn.textContent = currentExercise === 4 ? 'Finish Topic' : 'Next';
nextBtn.disabled = userAnswers[currentExercise] === undefined || userAnswers[currentExercise] === null;
nextBtn.addEventListener('click', () => {
if (currentExercise < 4) {
currentExercise++;
loadExercise(currentExercise);
updateProgress();
} else {
finishTopic();
}
});
nav.appendChild(prevBtn);
nav.appendChild(nextBtn);
exerciseContainer.appendChild(nav);
}

// Update progress bar and text
function updateProgress() {
const totalExercises = 5;
const progress = ((currentExercise + 1) / totalExercises) * 100;
progressFill.style.width = `${progress}%`;
progressText.textContent = `${currentExercise + 1}/${totalExercises}`;
}

// Finish topic and save score
function finishTopic() {
if (points > (topicBestScores[currentTopic] || 0)) {
topicBestScores[currentTopic] = points;
localStorage.setItem('polskiLernenBestScores', JSON.stringify(topicBestScores));
}
// Dynamic completion message
let message = "Keep practicing! ðŸ“š";
let color = "#f8961e";
if (points >= 45) {
message = "Outstanding! ðŸŒŸ";
color = "#4ade80";
} else if (points >= 35) {
message = "Great job! ðŸ‘";
color = "#4cc9f0";
} else if (points >= 25) {
message = "Good effort! ðŸ’ª";
color = "#f8961e";
}
completionMessage.textContent = message;
completionMessage.style.color = color;
exerciseContainer.classList.add('hidden');
progressContainer.classList.add('hidden');
finalScore.textContent = `${points}/50`; // CORRECT FORMAT
completionScreen.classList.remove('hidden');
}

// Show topic selection screen
function showTopicSelection() {
completionScreen.classList.add('hidden');
exerciseContainer.classList.add('hidden');
progressContainer.classList.add('hidden');
topicSelectionScreen.classList.remove('hidden');
renderTopicSelection();
}

// Initialize the app when page loads
window.addEventListener('load', initApp);
</script>
</body>
</html>